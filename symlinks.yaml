- defaults:
    link:
      create: true
      relink: true
      force: true

- clean: ['~', '${XDG_CONFIG_HOME}']

- shell:
  - description: Set XDG environmental variables
    command: source ./config/zsh/.zshenv
  - description: Remove legacy git config files if they exist
    command: |
      [ -f ~/.gitconfig ] && rm ~/.gitconfig || true
      [ -f ~/.gitignore_global ] && rm ~/.gitignore_global || true
  - description: Remove legacy ZSH config files if they exist (except .zshrc which will be symlinked)
    command: |
      [ -f ~/.zsh_history ] && rm ~/.zsh_history || true
      [ -f ~/.zprofile ] && rm ~/.zprofile || true
      [ -f ~/.zlogin ] && rm ~/.zlogin || true
      [ -f ~/.zlogout ] && rm ~/.zlogout || true
      [ -d ~/.zsh_sessions ] && rm -rf ~/.zsh_sessions || true
  - description: Remove additional legacy config files if they exist
    command: |
      [ -f ~/.vimrc ] && rm ~/.vimrc || true
      [ -f ~/.actrc ] && rm ~/.actrc || true
      [ -f ~/.claude.json ] && rm ~/.claude.json || true
      [ -f ~/.python_history ] && rm ~/.python_history || true
      [ -f ~/.z ] && rm ~/.z || true
      [ -f ~/.wget-hsts ] && rm ~/.wget-hsts || true

- create:
    - ~/Screenshots
    - ~/Herd

# Symlink locations for files / directories
- link:
    # Core shell configuration
    ~/.zshenv: { path: config/zsh/.zshenv, force: true }
    ~/.zshrc: { path: config/zsh/.zshrc, force: true }
    ~/.hushlogin: hushlogin

    # XDG-compliant configurations
    ${XDG_CONFIG_HOME}/zsh: config/zsh
    ${XDG_CONFIG_HOME}/nvim: config/nvim
    ${XDG_CONFIG_HOME}/git/config: config/git/.gitconfig
    ${XDG_CONFIG_HOME}/git/.gitignore_global: config/git/.gitignore_global
    ${XDG_CONFIG_HOME}/starship: config/starship
    ${XDG_CONFIG_HOME}/bat: config/bat
    ${XDG_CONFIG_HOME}/dircolors: config/dircolors
    ${XDG_CONFIG_HOME}/utils: utils

    # Additional XDG-compliant configurations
    ${XDG_CONFIG_HOME}/vim: config/vim
    ${XDG_CONFIG_HOME}/act: config/act
    ${XDG_CONFIG_HOME}/claude: config/claude
    ${XDG_CONFIG_HOME}/wget: config/wget

    # Security configurations (gnupg excluded - contains machine-specific keys)
    ${XDG_CONFIG_HOME}/ssh: config/ssh

    # Enhanced shell tools
    ${XDG_CONFIG_HOME}/fzf: config/fzf
    ${XDG_CONFIG_HOME}/zoxide: config/zoxide
    ${XDG_CONFIG_HOME}/tmux: config/tmux

    # Platform-specific configurations
    ${XDG_CONFIG_HOME}/Brewfile:
      if: '[ `uname` = Darwin ]'
      path: scripts/installs/Brewfile

    # VS Code settings (macOS)
    ~/Library/Application Support/Code/User/settings.json:
      if: '[ `uname` = Darwin ]'
      force: true
      path: applications/vscode/settings.json
    ~/Library/Application Support/Code/User/keybindings.json:
      if: '[ `uname` = Darwin ]'
      force: true  
      path: applications/vscode/keybindings.json
    ~/Library/Application Support/Code/User/snippets:
      if: '[ `uname` = Darwin ]'
      force: true
      path: applications/vscode/snippets
